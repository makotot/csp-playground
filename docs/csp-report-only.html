<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy-Report-Only" content="default-src 'self'; script-src 'self'; report-uri /csp-violation-report">
    <title>CSP - Report-Onlyãƒ¢ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .status-box {
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .info {
            background-color: #e3f2fd;
            border-left: 4px solid #2196F3;
        }
        .success {
            background-color: #e8f5e9;
            border-left: 4px solid #4CAF50;
        }
        .warning {
            background-color: #fff3e0;
            border-left: 4px solid #ff9800;
        }
        code {
            background-color: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: #2196F3;
            text-decoration: none;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        #violation-list {
            background-color: #fafafa;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
        }
        .violation-item {
            background-color: #fff;
            padding: 10px;
            margin: 5px 0;
            border-left: 3px solid #ff9800;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>ğŸ”’ Report-Onlyãƒ¢ãƒ¼ãƒ‰ã®ãƒ†ã‚¹ãƒˆ</h1>

    <div class="status-box info">
        <h2>CSPãƒãƒªã‚·ãƒ¼ï¼ˆReport-Onlyï¼‰</h2>
        <code>Content-Security-Policy-Report-Only: default-src 'self'; script-src 'self'</code>
        <p style="margin-top: 10px;">
            ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯<strong>Content-Security-Policy-Report-Only</strong>ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚<br>
            CSPé•åãŒç™ºç”Ÿã—ã¦ã‚‚å®Ÿè¡Œã¯<strong>ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œãš</strong>ã€é•åå†…å®¹ã®ã¿ãƒ¬ãƒãƒ¼ãƒˆã•ã‚Œã¾ã™ã€‚
        </p>
    </div>

    <div id="result" class="status-box success">
        <h3>çµæœ</h3>
        <p>â³ ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œå‰...</p>
    </div>

    <div class="status-box warning">
        <h3>Report-Onlyãƒ¢ãƒ¼ãƒ‰ã¨ã¯</h3>
        <p>
            <code>Content-Security-Policy-Report-Only</code>ã¯ã€CSPãƒãƒªã‚·ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆé‹ç”¨ã™ã‚‹ãŸã‚ã®ãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚
        </p>
        <h4>ç‰¹å¾´</h4>
        <ul>
            <li>CSPé•åãŒã‚ã£ã¦ã‚‚å®Ÿéš›ã«ã¯ãƒ–ãƒ­ãƒƒã‚¯ã—ãªã„</li>
            <li>é•åã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¨˜éŒ²</li>
            <li>report-uriã‚’è¨­å®šã™ã‚‹ã¨ã€ã‚µãƒ¼ãƒãƒ¼ã«é•åãƒ¬ãƒãƒ¼ãƒˆã‚’é€ä¿¡ã§ãã‚‹</li>
            <li>æœ¬ç•ªç’°å¢ƒã§CSPã‚’å°å…¥ã™ã‚‹å‰ã®ãƒ†ã‚¹ãƒˆã«æœ€é©</li>
        </ul>
        <h4>ä½¿ç”¨ã‚·ãƒ¼ãƒ³</h4>
        <ul>
            <li>æ—¢å­˜ã‚µã‚¤ãƒˆã«CSPã‚’å°å…¥ã™ã‚‹å‰ã®å½±éŸ¿èª¿æŸ»</li>
            <li>æ–°ã—ã„CSPãƒãƒªã‚·ãƒ¼ã®ãƒ†ã‚¹ãƒˆ</li>
            <li>æ®µéšçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–</li>
        </ul>
    </div>

    <div class="status-box">
        <h3>ç¢ºèªæ–¹æ³•</h3>
        <ol>
            <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ãï¼ˆF12ã‚­ãƒ¼ï¼‰</li>
            <li>Consoleã‚¿ãƒ–ã‚’ç¢ºèª</li>
            <li>CSPé•åã®<strong>è­¦å‘Š</strong>ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªï¼ˆã‚¨ãƒ©ãƒ¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰</li>
            <li>ä»¥ä¸‹ã®ã€Œçµæœã€ãŒç·‘è‰²ã§æˆåŠŸã¨è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ï¼‰</li>
        </ol>
        <p>
            <strong>æœŸå¾…ã•ã‚Œã‚‹è­¦å‘Š:</strong><br>
            <code>[Report Only] Refused to execute inline script because it violates the following Content Security Policy directive...</code>
        </p>
    </div>

    <div class="status-box">
        <h3>æ¤œå‡ºã•ã‚ŒãŸé•åï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰</h3>
        <div id="violation-list">
            <p>CSPé•åãŒæ¤œå‡ºã•ã‚Œã‚‹ã¨ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</p>
        </div>
    </div>

    <a href="index.html" class="back-link">â† ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>

    <!-- ã“ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€Œé•åã€ã¨ã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãŒã€å®Ÿè¡Œã•ã‚Œã‚‹ -->
    <script>
        console.log('âœ… ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸï¼ˆReport-Onlyãƒ¢ãƒ¼ãƒ‰ã®ãŸã‚ï¼‰');

        document.getElementById('result').className = 'status-box success';
        document.getElementById('result').innerHTML =
            '<h3>çµæœ</h3>' +
            '<p>âœ… ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã¾ã—ãŸ</p>' +
            '<p>Report-Onlyãƒ¢ãƒ¼ãƒ‰ã§ã¯ã€CSPé•åãŒã‚ã£ã¦ã‚‚å®Ÿè¡ŒãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã›ã‚“ã€‚</p>' +
            '<p>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>';

        // é•åãƒ¬ãƒãƒ¼ãƒˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º
        const violations = [
            {
                directive: 'script-src',
                blocked: 'inline script',
                line: 'ç´„170è¡Œç›®'
            },
            {
                directive: 'script-src',
                blocked: 'inline event handler',
                line: 'ç´„195è¡Œç›®'
            }
        ];

        const violationList = document.getElementById('violation-list');
        violationList.innerHTML = '<p><strong>æ¤œå‡ºã•ã‚ŒãŸCSPé•å:</strong></p>';

        violations.forEach((v, index) => {
            const item = document.createElement('div');
            item.className = 'violation-item';
            item.innerHTML = `
                <strong>é•å ${index + 1}:</strong><br>
                ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–: <code>${v.directive}</code><br>
                ãƒ–ãƒ­ãƒƒã‚¯å¯¾è±¡: ${v.blocked}<br>
                ä½ç½®: ${v.line}
            `;
            violationList.appendChild(item);
        });
    </script>

    <!-- ã“ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚‚é•åã¨ã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãŒã€å‹•ä½œã™ã‚‹ -->
    <div class="status-box" style="margin-top: 20px;">
        <button onclick="alert('ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸï¼\n\nã“ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚‚ Report-Only ãƒ¢ãƒ¼ãƒ‰ã®ãŸã‚å‹•ä½œã—ã¾ã™ã€‚')">
            ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆ
        </button>
        <p style="margin-top: 10px; font-size: 14px;">
            ã“ã®ãƒœã‚¿ãƒ³ã®onclickå±æ€§ã‚‚CSPé•åã§ã™ãŒã€Report-Onlyãƒ¢ãƒ¼ãƒ‰ã®ãŸã‚å‹•ä½œã—ã¾ã™ã€‚
        </p>
    </div>
</body>
</html>
