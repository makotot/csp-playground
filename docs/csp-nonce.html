<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'nonce-random123456'">
    <title>CSP - Nonceãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .status-box {
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .error {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
        }
        .success {
            background-color: #e8f5e9;
            border-left: 4px solid #4CAF50;
        }
        .warning {
            background-color: #fff3e0;
            border-left: 4px solid #ff9800;
        }
        code {
            background-color: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: #2196F3;
            text-decoration: none;
        }
        .back-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>ğŸ”’ Nonceï¼ˆãƒŠãƒ³ã‚¹ï¼‰ã®ãƒ†ã‚¹ãƒˆ</h1>

    <div class="status-box">
        <h2>CSPãƒãƒªã‚·ãƒ¼</h2>
        <code>Content-Security-Policy: default-src 'self'; script-src 'self' 'nonce-random123456'</code>
        <p style="margin-top: 10px;">
            ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯nonceå€¤ <code>random123456</code> ã‚’æŒã¤ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã¿å®Ÿè¡ŒãŒè¨±å¯ã•ã‚Œã¾ã™ã€‚
        </p>
    </div>

    <div id="result-with-nonce" class="status-box error">
        <h3>çµæœ1: Nonceä»˜ãã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>
        <p>â³ ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œå‰...</p>
    </div>

    <div id="result-without-nonce" class="status-box error">
        <h3>çµæœ2: Nonceãªã—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>
        <p>âŒ ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ</p>
        <p>ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆã€CSPãŒæ­£ã—ãæ©Ÿèƒ½ã—ã¦ã„ã¾ã™ã€‚</p>
    </div>

    <div class="status-box">
        <h3>Nonceã¨ã¯</h3>
        <p>
            Nonceï¼ˆNumber used onceï¼‰ã¯ã€ç‰¹å®šã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¨±å¯ã™ã‚‹ãŸã‚ã®ä¸€æ„ã®å€¤ã§ã™ã€‚<br>
            ã‚µãƒ¼ãƒãƒ¼å´ã§å‹•çš„ã«ç”Ÿæˆã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚
        </p>
        <h4>ãƒ¡ãƒªãƒƒãƒˆ</h4>
        <ul>
            <li>'unsafe-inline'ã‚’ä½¿ç”¨ã›ãšã«ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¨±å¯ã§ãã‚‹</li>
            <li>XSSæ”»æ’ƒã®ãƒªã‚¹ã‚¯ã‚’è»½æ¸›</li>
            <li>ç‰¹å®šã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã¿ã‚’é¸æŠçš„ã«è¨±å¯å¯èƒ½</li>
        </ul>
    </div>

    <div class="status-box">
        <h3>ç¢ºèªæ–¹æ³•</h3>
        <ol>
            <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ãï¼ˆF12ã‚­ãƒ¼ï¼‰</li>
            <li>Consoleã‚¿ãƒ–ã‚’ç¢ºèª</li>
            <li>ã€Œçµæœ1ã€ã¯æˆåŠŸã€ã€Œçµæœ2ã€ã¯CSPé•åã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª</li>
        </ol>
    </div>

    <a href="index.html" class="back-link">â† ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>

    <!-- Nonceä»˜ãã‚¹ã‚¯ãƒªãƒ—ãƒˆ: å®Ÿè¡Œã•ã‚Œã‚‹ -->
    <script nonce="random123456">
        console.log('âœ… Nonceä»˜ãã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ');
        document.getElementById('result-with-nonce').className = 'status-box success';
        document.getElementById('result-with-nonce').innerHTML =
            '<h3>çµæœ1: Nonceä»˜ãã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>' +
            '<p>âœ… ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã¾ã—ãŸ</p>' +
            '<p>Nonceå€¤ãŒä¸€è‡´ã—ãŸãŸã‚ã€ã“ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯è¨±å¯ã•ã‚Œã¾ã—ãŸã€‚</p>';
    </script>

    <!-- Nonceãªã—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ -->
    <script>
        console.log('ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ï¼ˆCSPã«ã‚ˆã£ã¦ãƒ–ãƒ­ãƒƒã‚¯ï¼‰');
        document.getElementById('result-without-nonce').className = 'status-box warning';
        document.getElementById('result-without-nonce').innerHTML =
            '<h3>çµæœ2: Nonceãªã—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>' +
            '<p>âš ï¸ ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ</p>' +
            '<p>CSPãŒæ©Ÿèƒ½ã—ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>';
    </script>
</body>
</html>
